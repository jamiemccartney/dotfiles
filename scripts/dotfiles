#!/usr/bin/env bash
set -euo pipefail

if [[ "$(basename "$PWD")" != "dotfiles" ]]; then
  echo "Error: Script must be run from the 'dotfiles' directory, not '$PWD'." >&2
  exit 1
fi

if [[ $# -eq 0 ]]; then
  echo "Usage: ./scripts/dotfiles <command>"
  echo ""
  echo "Commands:"
  echo "  init     Create symlinks and clone repos"
  echo "  update   Update all repos to latest"
  exit 1
fi

SCRIPTS_DIR="./scripts"
source "$SCRIPTS_DIR/consts.sh"

case "$1" in
  init)
    echo "ðŸš€ Initializing dotfiles..."
    bash "$SCRIPTS_DIR/installs.sh"
    bash "$SCRIPTS_DIR/symlinks.sh"
    bash "$SCRIPTS_DIR/repos.sh" init
    ;;
  update)
    echo "ðŸ”„ Updating dotfiles..."
    bash "$SCRIPTS_DIR/repos.sh" update
    ;;
  *)
    echo "Unknown command: $1"
    exit 1
    ;;
esac

echo "âœ…Done!"
